(* -*- tuareg -*- *)

open Jbuild_plugin.V1

let flags =
  match List.assoc "target" ocamlc_config with
  | "aarch64-unknown-linux-musl"
  | "x86_64-pc-linux-musl" -> "(:standard -cclib -static -cclib -no-pie)"
  | _ -> "(:standard)"

let () =
  Printf.ksprintf send {|
(executable
 (name main)
 (public_name platform)
 (flags %s)
 (libraries platform cmdliner))
|} flags
